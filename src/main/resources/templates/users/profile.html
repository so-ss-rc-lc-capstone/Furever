<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:replace="partials/header :: head">
    <title>
        Profile page
    </title>
</head>
<link rel="stylesheet" href="/css/calendar2.css">
<link href='https://unpkg.com/css.gg@2.0.0/icons/css/add.css' rel='stylesheet'>

<body>


<nav th:replace="partials/navbar :: navbar"></nav>
<nav th:replace="partials/navbar :: navbar-mobile"></nav>
<div th:fragment="participation-modal" id="defaultModal" tabindex="-1" aria-hidden="true" class="fixed top-0 left-0 right-0 bottom-0 z-50 hidden flex items-center justify-center flex-col">
    <div class="absolute h-screen inset-0 bg-black opacity-50 flex justify-center items-center" onclick="hideModal()"></div>
    <div class="relative w-full max-w-2xl max-h-full bg-white rounded-lg shadow dark:bg-gray-700 items-center">
        <!-- Modal content -->
        <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
            <!-- Modal header -->
            <div class="flex items-start justify-between p-4 border-b rounded-t dark:border-gray-600">
                <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
                    Participants
                </h3>
                <button type="button" id="close-btn" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="defaultModal" onclick="hideModal()">
                    <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                    <span class="sr-only">Close modal</span>
                </button>
            </div>
            <!-- Participants -->
            <div id="view-participants-list" class="p-6 space-y-6">
            </div>
        </div>
    </div>
</div>


<div class="w-full h-screen">
    <div class="h-2/3 relative"
         style="background-image: url('https://imgtr.ee/images/2023/04/11/n5rU7.jpg'); background-position: center; background-size: cover;">

    </div>
    <div class="flex justify-center">

        <div class="w-full md:w-4/5 flex flex-col justify-between bg-white">
            <div class="h-[20px] w-full flex justify-center md:justify-start " style="transform: translateY(-700%)">
                <div class="w-[17em] h-[17em] flex flex-col justify-center rounded-full items-center md:items-start">
                    <div class="w-[170px] h-[170px] relative flex justify-center items-center bg-white rounded-full">

                        <img class="w-[160px] h-[160px] rounded-full shadow-lg"
                               th:if="${not #strings.isEmpty(user.profilePhoto)}"
                               th:src="${user.profilePhoto}"
                               alt="Profile image"/>

                        <img class="w-[160px] h-[160px] rounded-full shadow-lg"
                             th:unless="${not #strings.isEmpty(user.profilePhoto)}"
                             th:src="@{/img/profile.jpeg}"
                             alt="Default profile image"/>

                        <div th:if="${user.id} == ${#authentication.principal.id}" class="absolute bottom-4">
                            <h3>
                                <form th:action="@{/profile/edit}" method="get">
                                <button type="submit" class ="text-blue-500 hover:cursor-pointer underline underline-offset-1 text-[15px]">Edit Profile</button>
                                </form>

                            </h3>
                        </div>

                    </div>


                </div>

            </div>


            <!--Edit profile-->
            <div class="w-full flex mt-[3em] justify-end ">

                <div class="w-full flex ml-[20px] justify-start mr-[4em]" th:if="${user.id == #authentication.principal.id}">

                    <div class="dropdown relative">

                        <button id="dropdownButton-${event.id}" class=" ml-5 md:ml-0 rounded-full hover:cursor-pointer text-center inline-flex items-center  dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="ri-more-fill" style="font-size: 1.5em; opacity: 0.7"></i>                      </button>

                        <div class="dropdown-menu hidden absolute w-[100px] z-999 dropdown-menu-right bg-white divide-y divide-gray-100 rounded-lg shadow w-44 dark:bg-gray-700" aria-labelledby="dropdownDefaultButton-${event.id}">
                            <form th:action="@{/profile/edit}" method="get">
                                <button type="submit" class="block flex p-3 text-gray-500 hover:text-gray-400 dark:hover:bg-gray-600 dark:hover:text-white dropdown-item">Edit Profile</button>
                            </form>
                            <form  th:action="@{/profile/delete}" method="get" id="deleteForm">
                                <button type="submit" class="block flex p-3 text-red-500 hover:text-red-400 dark:hover:bg-gray-600 dark:hover:text-white dropdown-item">Delete Profile</button>
                            </form>
                        </div>
                    </div>
                </div>

            </div>



            <!--Bio-->
            <div class=" flex flex-col justify-center items-center md:items-start md:justify-start w-full">
                <div class ="flex flex-col items-start justify-center md:flex-row w-full">
                <div class="w-3/5 flex justify-center items-center md:justify-start md:items-start">
                    <div class="w-full flex flex-col justify-center items-center md:items-start md:justify-end">



                        <span class="text-2xl font-bold mb-1" th:text="${#strings.isEmpty(user.first_name) ? 'New User' : user.first_name + (user.last_name != null ? ' ' + user.last_name : '')}"></span>




                        <div class="text-[15px] flex mb-3 mt-1 text-center md:text-end"
                             th:if="${not #strings.isEmpty(user.address)}">
                            <svg fill="none" class="h-[18px] " stroke="currentColor" stroke-width="1.5"
                                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                      d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round"
                                      d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"></path>
                            </svg>
                            <span class="text-gray-500 text-[13px]" th:text="${user.address}"></span>
                        </div>




                        <h2 class="text-gray-800 text-[13px] mb-2"> @<span class="text-black" th:text="${user.username}"></span>  <span class="text-[15px] font-bold text-gray-500">﹒</span> <span th:text="${user.email}"></span></h2>

                        <div class="flex w-full justify-evenly md:justify-start" th:if="${user.id} != ${#authentication.principal.id}">
                            <form th:action="@{/users/{id}/follow(id=${user.id})}" th:method="post"
                                  class="mb-4 mt-3 md:mr-[5em]">
                                <button th:text="${followedUsers.contains(user) ? 'Follow' : 'Following'}" type="submit" class="inline-flex items-center px-4 py-2 text-sm font-medium text-center text-black border-2 rounded-lg hover:bg-gray-200 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"></button>
                            </form>
                        </div>

                        <div class="w-2/3 h-[5em] mb-[4em] md:mb-0 text-[15px] text-center md:text-start md:block"
                             th:text="${user.bio}" style="overflow-wrap: break-word;">
                        </div>


                    </div>

                </div>


                <!--Calendar-->
                <div class="flex w-[50em] justify-center items-center md:mr-[3em] md:mt-0 md:justify-end">

                    <!--calendar section-->
                    <div class="calendar-container ml-[50px] w-[50em] h-[30em]" style="z-index: 10;">
                        <div class="wrapper w-full">
                            <header>
                                <p class="current-date"></p>
                                <div class="icons">
                                    <span id="prev" class="material-symbols-rounded"><</span>
                                    <span id="next" class="material-symbols-rounded">></span>
                                </div>
                            </header>
                            <div class="calendar">
                                <ul class="weeks">
                                    <li>Sun</li>
                                    <li>Mon</li>
                                    <li>Tue</li>
                                    <li>Wed</li>
                                    <li>Thu</li>
                                    <li>Fri</li>
                                    <li>Sat</li>
                                </ul>
                                <ul class="days"></ul>
                            </div>
                        </div>


                    </div>


                </div>
                </div>
            <!--Pets-->
            <div class="w-full flex mt-[3em] flex-col justify-center items-center md:justify-start md:items-start">
                <div class="flex md:justify-start md:items-start">
                    <h2 class="font-bold mb-2 ml-7 md:ml-0 mr-2">My Pets</h2>
                    <form th:action="@{/pets/register}" method="get">
                        <input type="hidden" name="edit_id"/>
                        <button type="submit" class=" pb-2 md:pb-0 text-blue-700">
                            + Add
                        </button>
                    </form>
                </div>

                <div class="w-full flex mb-[1em] mt-[1em] justify-center items-center md:justify-start md:items-center">
                    <div class="mt-2" th:include="pets/pet-card :: petList">
                    </div>
                </div>

                <!--Events-->

                <div class="flex flex-col w-full h-screen mt-5  justify-center">
                    <div class=" w-full">
                        <ul class="hidden text-sm font-medium text-center text-gray-500 divide-x divide-gray-200 rounded-lg shadow sm:flex dark:divide-gray-700 dark:text-gray-400">
                            <li class="w-full">
                                <button id="feed" class="inline-block w-full p-4 text-gray-900 bg-gray-100 rounded-l-lg dark:bg-gray-700 dark:text-white" aria-current="page">Feed</button>
                            </li>
                            <li class="w-full">
                                <button id="events" class="inline-block w-full p-4 bg-white hover:text-gray-700 hover:bg-gray-50 dark:hover:text-white dark:bg-gray-800 dark:hover:bg-gray-700">Events</button>
                            </li>

                        </ul>

                    </div>

                    <!--Render Posts-->
                    <div class="w-full h-screen grid grid-cols-1" id = "posts-container" style="overflow: auto;">
                        <div th:each="post : ${posts}" th:if="${post.user.id == user.id}"  class = "bg-white rounded-t-lg mt-2">
                            <div class="w-full rounded-t-lg dark:border-gray-700" >

                                <div class="flex">
                                    <div class="flex justify-center">
                                        <img class="w-[55px] h-[55px] mt-[26px] ml-7 rounded-full shadow-md"
                                             th:if="${not #strings.isEmpty(post.user.profilePhoto)}"
                                             th:src="${post.user.profilePhoto}" alt="Profile image"/>

                                        <img class="w-[55px] h-[55px] mt-[26px] ml-7 rounded-full shadow-md"
                                             th:if="${#strings.isEmpty(post.user.profilePhoto)}"
                                             th:src="@{/img/profile.jpeg}"
                                             alt="Default profile image"/>
                                    </div>


                                    <!--Name Date body-->
                                    <div id="name-body" class = "mt-[20px] w-full">
                                        <div class="ml-5">
                                            <h1 class="font-bold text-[22px] mt-1"> <span th:text="${post.user.first_name}"></span> <span th:text="${post.user.last_name}"></span></h1>
                                            <h3 class = "text-blue-400 mt-1"><a th:href="@{/user/{id}(id=${post.user.id})}"> @ <span th:text="${post.user.username}"></span></a></h3>
                                            <h3 class="text-[10px] text-gray-400 mt-1"><span th:text="${#temporals.format(post.created_at, 'h:mm a')}"></span> ﹒ <span th:text="${#temporals.format(post.created_at, 'MMMM dd, yyyy')}"></span></h3>

                                            <div class="w-full pb-5 pt-[5px] ml-[2px] text-[18px]" th:text="${post.body}"></div>

                                            <!--Post Image-->
                                            <div class="w-full flex justify-center items-center mb-5"> <span><img th:src="${post.image}" class=" w-[40em] mt-2 h-[20em]"></span></div>


                                        </div>
                                    </div>
                                </div>
                                <div class="w-full h-[30px] pb-3 border-b border-gray-300 flex flex-row justify-around ">

                                    <div class="flex flex-row justify-center items-center hover:text-blue-500 hover:cursor-pointer transition-all">
                                        <svg fill="none" class="h-[20px] w-[20px] flex justify-center" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 01-.923 1.785A5.969 5.969 0 006 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337z"></path>
                                        </svg>
                                        <form th:action="@{/posts/{id}/show (id=${post.id})}" method="get">
                                            <input type="hidden" name="event" th:value="${post.id}"/>
                                            <button><span th:text="${post.comments.size}" class="ml-1 mr-1"></span>Comments</button>
                                        </form>
                                    </div>
                                    <!--                    Like functionality-->
                                    <form th:action="@{'/posts/' + ${post.id} + '/profile-like'}" method="post">
                                        <button type="submit">
                                            <div class="flex flex-row justify-center items-center hover:text-red-500 hover:cursor-pointer transition-all">
                                                <svg fill="none" class="h-[20px] w-[20px] flex justify-center" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"
                                                     th:classappend="${post.hasLiked(#authentication.principal.id) ? 'text-red-500 fill-red-500' : ''}">
                                                    <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"></path>
                                                </svg>
                                                <span class="ml-1 mr-1" th:text="${post.likes.size}"></span>
                                                <h3>Likes</h3>
                                            </div>
                                        </button>
                                    </form>
                                </div>


                            </div>


                        </div>


                    </div>

                        <!--Render Photos or events-->
                        <div class="w-full hidden h-screen grid grid-cols-1" id = "events-container" style="overflow: auto;">

                            <div th:each="event : ${events}" th:if="${event.hasParticipated(#authentication.principal.id)}"
                                 class="flex flex-col mt-[4em] justify-between border w-full h-[25em] mb-5 pb-5 border-gray-200 rounded-lg shadow dark:border-gray-700"

                                 th:style="'background-image:url(\'' + ${event.eventPhoto} + '\'); background-size:cover; background-position:center;'">


                                <div class=" w-full mt-[10px] h-[3em]">
                                    <div class="w-full flex items-center justify-between">


                                        <form th:action="@{'/events/' + ${event.id} + '/participate'}" method="post">
                                            <button id="color-toggle" type="submit"
                                                    class="bg-white w-[150px] duration-75 h-[45px] ml-[4em] text-black font-medium rounded-lg text-sm px-5 py-2.5 text-center"
                                                    th:classappend="${event.hasParticipated(#authentication.principal.id) ? 'bg-white text-black' : ''}">
                                                <span th:text="${event.hasParticipated(#authentication.principal.id) ? 'Attending' : 'Participate'}"></span>
                                            </button>
                                        </form>


                                        <!--Delete btn-->
                                        <div class="w-full flex justify-end" th:if="${event.user.id} == ${#authentication.principal.id}">
                                            <form th:action="@{/events/{id}/delete(id=${event.id})}" method="get" onsubmit="return confirmDelete();">
                                                <input type="hidden" name="delete_id" th:value="${event.id}"/>
                                                <button type="submit"
                                                        class="flex items-center mr-[4em] justify-center text-white h-12 w-[60px] rounded-lg bg-red-600 hover:bg-red-800 font-medium text-sm text-center inline-flex items-center dark:bg-blue-600">
                                                    <h2 class="text-white">Delete</h2>
                                                </button>
                                            </form>
                                        </div>


                                        <div th:if="${event.user.id} != ${#authentication.principal.id}">
                                            <button type="button"
                                                    class="flex items-center mr-[4em] justify-center text-white h-12 w-12 bg-white hover:bg-gray-100 font-medium rounded-full text-sm text-center inline-flex items-center dark:bg-blue-600">
                                                <svg class="black w-5" fill="none" stroke="black" stroke-width="1.5" viewBox="0 0 24 24"
                                                     xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                          d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                </div>


                                <div class=" flex justify-center items-center w-full h-[10em]">
                                    <!--Event Description-->
                                    <div class="w-full md:w-4/5 h-full bg-white rounded-xl">

                                        <div class="flex flex-row w-full h-2/3 justify-between">
                                            <div class="w-2/3">
                                                <div class="w-full">
                                                    <h2 class="text-2xl font-bold pl-3 pt-1 pr-3" th:text="${event.title}"></h2>
                                                    <div class="text-sm pl-3 pr-3 pb-3">

                                                        <p class="text-[14px]" th:text="${#temporals.format(event.event_DateAndTime, 'dd-MMM-yyyy h:mm a')}"></p>
                                                    </div>


                                                </div>

                                            </div>
                                            <div class="flex pt-3 pr-3">
                                                <div class="view-participants-btn w-1/3 h-1/3 text-[10px] flex items-center mr-4"><h3 class="text-blue-600">
                                                    <a class="view-participants-btn hover:cursor-pointer" data-modal-target="defaultModal" data-modal-toggle="defaultModal" th:data-event-id="${event.id}">Participants</a>
                                                </h3></div>

                                                <div class="flex h-1/3 -space-x-4">
                                                    <a th:each="participation, i : ${event.participations}" th:if="${i.index &lt; 3}">
                                                        <img class="w-9 h-9 border-2 border-white rounded-full dark:border-gray-800"
                                                             th:if="${not #strings.isEmpty(participation.user.profilePhoto)}"
                                                             th:src="${participation.user.profilePhoto}" alt="Profile image"/>
                                                        <img class="w-9 h-9 border-2 border-white rounded-full dark:border-gray-800"
                                                             th:unless="${not #strings.isEmpty(participation.user.profilePhoto)}"
                                                             th:src="@{/img/profile.jpeg}" alt="Default profile image"/>
                                                    </a>

                                                    <a class="flex items-center justify-center w-9 h-9 text-xs font-medium text-white bg-gray-700 border-2 border-white rounded-full hover:bg-gray-600 dark:border-gray-800"
                                                       href="#"><span th:text="${event.participations.size}"></span></a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="w-full h-1/3">
                                            <div class="flex pl-3 items-center space-x-4 justify-between">
                                                <div class="flex ">
                                                    <img class="w-10 h-10 rounded-full mr-3" th:src="${#strings.isEmpty(event.user.profilePhoto) ? '/img/profile.jpeg' : event.user.profilePhoto}">
                                                    <div class="font-medium dark:text-white">
                                                        <div><span th:text="${event.user.getUsername()}"></span></div>
                                                        <div class="text-[10px] text-gray-500 dark:text-gray-400"
                                                        ><h4>Created at <span class="text-[10px] text-gray-500 dark:text-gray-400"
                                                                              th:text="${#temporals.format(event.created_at, 'dd-MMM-yyyy h:mm a')}"></span></h4></div>
                                                    </div>
                                                </div>
                                                <form th:action="@{/events/{id}/edit(id=${event.id})}" method="get">
                                                    <div th:if="${event.user.id} == ${#authentication.principal.id}">
                                                        <input type="hidden" name="edit_id" th:value="${event.id}"/>
                                                        <button type="submit"
                                                                class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-3 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800">
                                                            Edit
                                                        </button>
                                                    </div>
                                                </form>
                                                <div>
                                                    <form th:action="@{/events/{id}/find (id=${event.id})}" method="get">
                                                        <input type="hidden" name="event" th:value="${event.id}"/>
                                                        <button type="submit"
                                                                class="text-white bg-blue-700 hover:bg-blue-800 font-medium rounded-lg text-sm px-5 py-2.5 mr-3 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800">
                                                            See Details
                                                        </button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>





                </div>


            </div>
        </div>

    </div>

</div>

<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.5.1/moment.min.js"></script>

<script src="/js/calendar2.js"></script>





<script>
    const feedBtn = document.getElementById("feed");
    const eventsBtn = document.getElementById("events");
    const postsContainer = document.getElementById("posts-container");
    const eventsContainer = document.getElementById("events-container")

    feedBtn.addEventListener('click', () => {
        feedBtn.classList.add('bg-gray-100');
        eventsBtn.classList.remove('bg-gray-100');
        postsContainer.style.display = 'block';
        eventsContainer.style.display = 'none';
    });

    eventsBtn.addEventListener('click', () => {
        eventsBtn.classList.add('bg-gray-100');
        feedBtn.classList.remove('bg-gray-100');
        postsContainer.style.display = 'none';
        eventsContainer.style.display = 'block';
    });



    const dropdownMenu = document.querySelector(".dropdown-menu");
    const dropdownButton = document.querySelector(".dropdown-toggle");

    dropdownButton.addEventListener("click", () => {
        dropdownMenu.classList.toggle("hidden");
        document.addEventListener("click", hideDropdownMenu);
    });

    function hideDropdownMenu(event) {
        if (!dropdownButton.contains(event.target) && !dropdownMenu.contains(event.target)) {
            dropdownMenu.classList.add("hidden");
            document.removeEventListener("click", hideDropdownMenu);
        }
    }




    const modal = document.getElementById('defaultModal');
    const closeBtn = document.getElementById('close-btn');
    const modalToggle = document.querySelectorAll('[data-modal-toggle]');
    const modalClose = document.querySelectorAll('[data-modal-hide]');

    modalToggle.forEach((toggle) => {
        toggle.addEventListener('click', () => {
            const target = toggle.getAttribute('data-modal-target');
            const modalTarget = document.getElementById(target);
            modalTarget.classList.toggle('hidden');
        });
    });

    modalClose.forEach((toggle) => {
        toggle.addEventListener('click', () => {
            const target = toggle.closest('.modal').getAttribute('id');
            const modalTarget = document.getElementById(target);
            modalTarget.classList.toggle('hidden');
        });
    });

    function hideModal() {
        document.getElementById("defaultModal").classList.add("hidden");
    }


    //Modal div
    let participantsList = document.getElementById("view-participants-list");
    let allBtns = document.querySelectorAll('.pt-3.pr-3 .view-participants-btn');

    allBtns.forEach(event => {
        event.addEventListener('click', function() {
            participantsList.innerHTML = "";
            console.log("clicked");
            // Get the event ID from the "data-event-id" attribute of the button
            let eventId = event.getAttribute("data-event-id");
            console.log(eventId);

            // Fetch participants for the selected event
            fetch('http://localhost:8080/events/' + eventId + '/participants', {
                method: "GET",
                headers: {
                    "Content-Type": "application/json",
                }
            })
                .then(res => {
                    if (!res.ok) {
                        throw new Error("Network response was not ok");
                    }
                    return res.json();
                })
                .then(data => {
                    console.log(data);
                    let viewParticipants = JSON.stringify(data);
                    getAllParticipants(viewParticipants);
                })
                .catch(error => console.error(error));
        });
    });










    function getAllParticipants(data){
        let viewParticipants = JSON.parse(data);
        let html = '';
        for(let i = 0; i < viewParticipants.length; i++){
            html += `<div class="flex justify-center items-center w-full flex-col">
                <div class="flex w-full h-[6em] rounded-full" style="box-shadow: 0 4px 24px hsla(222,68%,20%, .1); overflow: hidden; transition: width .5s cubic-bezier(.9, 0, .3, .9)">
                <div class="flex w-full">
                <div class="flex justify-between p-3 w-full" >
                  <div class="flex items-center ml-[1em]">
                  <img class="w-[50px] h-[50px] rounded-full mr-4" src="${viewParticipants[i].profilePhoto || '/img/profile.jpeg'}" alt="Profile image"/>
                  <div>
                    <p>${viewParticipants[i].first_name ?? ''} ${viewParticipants[i].last_name ?? '' ? viewParticipants[i].last_name : ''} ${viewParticipants[i].first_name === null && viewParticipants[i].last_name === null ? 'User' : ''}</p>
                    <p class="text-gray-400">@${viewParticipants[i].username}</p></div>

                    </div>

                    <div class="flex w-1/3 items-center justify-evenly mr-3">

                   <a class="hover:cursor-pointer"> <div class="flex justify-center items-center w-[40px]">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-chat-fill transition duration-300 text-gray-300 hover:text-gray-500"  viewBox="0 0 16 16">
                      <path d="M8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6-.097 1.016-.417 2.13-.771 2.966-.079.186.074.394.273.362 2.256-.37 3.597-.938 4.18-1.234A9.06 9.06 0 0 0 8 15z"/>
                    </svg>
                    </div></a>

                    <a class="hover:cursor-pointer" href="/user/${viewParticipants[i].id}">
                    <div class="flex justify-center items-center w-[40px]">
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi text-gray-300 hover:text-gray-500 transition duration-300  bi-person-circle" viewBox="0 0 16 16">
                          <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                          <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                        </svg>
                        </div>
                     </a>
                    </div>


                  </div>
                </div>
              </div>
            </div>`;


        }
        participantsList.innerHTML = html;
    }

    //delete
    function confirmDelete() {
        if (confirm("Are you sure you want to delete this event?")) {
            return true;
        } else {
            return false;
        }
    }

    function confirmUserDelete() {
        if (confirm("Are you sure you want to delete your profile?")) {
            document.getElementById("deleteForm").submit();
        }
    }



    const pingIcon = document.querySelector('.nav-link div > .ping-icon');

        // Check if the ping icon should be hidden on page load
    const pingIconHidden = localStorage.getItem('pingIconHidden');
    if (pingIconHidden) {
        pingIcon.forEach(icon => icon.classList.add('hidden'));
    }

        // Add event listener to hide ping icon on hover and set local storage item
    const link = document.querySelector('.nav-link div a');
    link.addEventListener('mouseover', () => {
        pingIcon.forEach(icon => icon.classList.add('hidden'));
        localStorage.setItem('pingIconHidden', true);
    });



</script>

</body>
</html>